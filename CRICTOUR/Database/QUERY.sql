SELECT *
FROM PERSON
ORDER BY PERSONID;

SELECT * 
FROM UMPIRE;

CREATE TABLE ADMIN(
EMAIL VARCHAR(255),
PASSWORD VARCHAR(255)
);

INSERT INTO ADMIN (EMAIL, PASSWORD)
VALUES ('gouroveroy456@gmail.com', '12345');
INSERT INTO ADMIN (EMAIL, PASSWORD)
VALUES ('gouroveroy71@gmail.com', '12345');


SELECT *
FROM USERS;

SELECT * FROM UMPIRE;

SELECT * FROM PERSON p ;

SELECT * FROM VENUE v ;

SELECT * FROM TOURNAMENT;

DELETE FROM TOURNAMENT
WHERE TOURNAMENT_ID IN (5, 6);

UPDATE TOURNAMENT
SET TOURNAMENT_ID = 4
WHERE TOURNAMENT_ID = 7;

DELETE FROM SCORECARD;

SELECT * FROM SCORECARD;

SELECT
    (P.FIRST_NAME || ' ' || P.LAST_NAME) AS FULL_NAME,
    P.NATIONALITY,
    EXTRACT(YEAR FROM CURRENT_DATE) - EXTRACT(YEAR FROM C.START_DATE_OF_CAREER) AS COACHING_TIME,
    P.IMAGE,
    P.PERSONID,
    (
        SELECT TEAM_NAME
        FROM TEAM T
        WHERE T.TEAM_ID = C.TEAM_ID
    ) AS TEAM_NAME
FROM COACH C
JOIN PERSON P ON C.PERSONID = P.PERSONID;



SELECT
                (P.FIRST_NAME || ' ' || P.LAST_NAME) AS FULL_NAME,
                P.NATIONALITY,
                EXTRACT(YEAR FROM CURRENT_DATE) - EXTRACT(YEAR FROM DATE_OF_BIRTH) AS AGE,
                P.IMAGE,
                P.PERSONID,
                C.NO_OF_MATCH_CONDUCTED
            FROM
                UMPIRE C
            JOIN
                PERSON P ON
                C.PERSONID = P.PERSONID;

SELECT * FROM POINT_TABLE;
SELECT * FROM TOURNAMENT;
UPDATE TOURNAMENT SET TOURNAMENT_ID = 3
WHERE TOURNAMENT_ID = 6;

SELECT * FROM USERS;
SELECT * FROM PLAYER;
SELECT * FROM PERSON;

SELECT
                    P.IMAGE,
                    (P.FIRST_NAME || ' ' || P.LAST_NAME) AS FULL_NAME,
                    T.TEAM_NAME AS TEAM,
                    PL.TYPE,
                    EXTRACT(YEAR FROM CURRENT_DATE) - EXTRACT(YEAR FROM P.DATE_OF_BIRTH) AS AGE
                FROM PLAYER PL
                JOIN PERSON P ON PL.PLAYERID = P.PERSONID
                LEFT JOIN TEAM T ON PL.TEAM_ID = T.TEAM_ID;

INSERT INTO PLAYER (PLAYERID)
SELECT P.PERSONID
FROM PERSON P;

INSERT INTO Bowler (playerId)
SELECT playerId
FROM Player
WHERE type = 'Bowler';

-- Insert batsmen data into Batsman table
INSERT INTO Batsman (playerId, Batting_Style)
SELECT playerId, 'Batsman' FROM Player WHERE type = 'Batsman';

SELECT * FROM POINT_TABLE;

SELECT T.TEAM_NAME AS NAME,
P.MATCHES MATCHES,
                P.WON WON, P.LOST LOST, P.DRAW DRAW, P.POINTS POINTS, P.NRR NRR
                FROM POINT_TABLE P JOIN TEAM T
                ON (P.TEAM_ID = T.TEAM_ID);


SELECT * FROM PERSON;
SELECT * FROM BATSMAN;
SELECT * FROM BOWLER;
SELECT * FROM MATCH;
SELECT * FROM SCORECARD;

DELETE FROM MATCH;
DELETE FROM SCORECARD;

SELECT S.*
FROM SCORECARD S
JOIN MATCH M
ON S.MATCH_ID = M.MATCH_ID
AND S.MATCH_ID = 1;

-- DELETING ALA DATA FROM SCORECARD TABLE
DELETE FROM SCORECARD;

SELECT * FROM MATCH_UMPIRE;
DELETE FROM MATCH_UMPIRE;

SELECT * FROM UMPIRE;
SELECT * FROM TOURNAMENT;

SELECT * FROM GET_PLAYERS_IN_TOURNAMENT(4);

SELECT TEAM_ID, COUNT(*)
FROM PLAYER
WHERE TEAM_ID IN (SELECT TEAM_ID FROM TEAM_PARTICIPATION WHERE TOURNAMENT_ID = 4)
GROUP BY TEAM_ID
HAVING COUNT(*) > 1;

SELECT TOURNAMENT_ID, GET_PLAYERS_IN_TOURNAMENT(TOURNAMENT_ID)
FROM TOURNAMENT
WHERE TOURNAMENT_ID = 4;


SELECT DISTINCT P.*, PR.FIRST_NAME || PR.LAST_NAME
        FROM PERSON PR
        JOIN PLAYER P ON P.PLAYERID = PR.PERSONID
        JOIN TEAM_PARTICIPATION TP ON P.TEAM_ID = TP.TEAM_ID
        JOIN MATCH M ON TP.TOURNAMENT_ID = M.TOURNAMENT_ID
        WHERE M.TOURNAMENT_ID = 4

SELECT DISTINCT T.TEAM_ID, CALCULATE_TEAM_POINTS(T.TEAM_ID)
FROM TEAM T
JOIN TEAM_PARTICIPATION TP ON T.TEAM_ID = TP.TEAM_ID
JOIN MATCH M ON TP.TOURNAMENT_ID = M.TOURNAMENT_ID
WHERE M.TOURNAMENT_ID = 4;

SELECT DISTINCT T.TEAM_ID, CALCULATE_TEAM_POINTS(T.TEAM_ID)
FROM TEAM T
JOIN TEAM_PARTICIPATION TP ON T.TEAM_ID = TP.TEAM_ID
JOIN MATCH M ON TP.TOURNAMENT_ID = M.TOURNAMENT_ID
JOIN SCORECARD S ON T.TEAM_ID = S.TEAM_ID  -- Specify the table for player_id
WHERE M.TOURNAMENT_ID = 4;

SELECT SUM(DREAM11_PLAYERS_POINT(PLAYERID))
FROM PLAYER
WHERE TEAM_ID = 80;

SELECT * FROM DREAM11;
DELETE FROM DREAM11;

SELECT CALCULATE_TOTAL_DREAM11_POINTS();
SELECT COMPARE_TEAMS_IN_TOURNAMENT(4);

SELECT * FROM SCORECARD;
SELECT * FROM UMPIRE;

SELECT GET_TEAM_ID('BUET_Royal_Flash');
SELECT * FROM TOURNAMENT;
SELECT GET_PLAYER_ID('rohit sharma');
SELECT GET_COACH_ID('LALCHAND rajput');
SELECT * FROM TEAM;

SELECT COALESCE(MAX(SUBSTRING(CAST(PLAYERID AS VARCHAR), 3, LENGTH(CAST(PLAYERID AS VARCHAR)) - 2))::INTEGER, 0) + 1
FROM PLAYER
WHERE TEAM_ID = 71;

SELECT CAST(TEAM_ID AS VARCHAR) || '1' || CAST((SELECT COUNT(*) + 1 FROM PLAYER WHERE TEAM_ID = 81) AS VARCHAR)::INTEGER + 1
FROM TEAM
WHERE TEAM_ID = 81;

SELECT * FROM PERSON
WHERE PERSONID = 81111;

DELETE FROM PLAYER WHERE PLAYERID = 81111;

UPDATE PERSON SET NATIONALITY = 'ZIMBABWE'
WHERE PERSONID = 81111;

SELECT * FROM TOURNAMENT;
SELECT * FROM DELETED_TOURNAMENT;

SELECT * FROM NEWS;

SELECT JERSEY.TEAM_ID, TEAM.TEAM_NAME, JERSEY.COLOR
FROM JERSEY
JOIN TEAM
ON JERSEY.TEAM_ID = TEAM.TEAM_ID;


